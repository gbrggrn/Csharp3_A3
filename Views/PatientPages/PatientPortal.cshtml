@page
@model Csharp3_A1.Pages.PatientPages.PatientPortalModel
@{
	ViewData["Title"] = "Patient portal";
}
<!-- See Staff/StaffDashboard or Shared/Layout for doing a menu with .nav, I wanted to try mixing in C# ->
<!-- Browser query for button navigation -->
@{
	var section = Request.Query["section"].ToString() ?? "Profile"; //Request value of "section" - default to "Profile"
}
@{
	Layout = "_MinimalLayout";
}

<div class="container mt-3">
	<div class="row">

		<!-- Sidebar menu -->
		<div class="col-md-4">
			<div class="d-flex flex-column gap-2 p-2 bg-info bg-opacity-50 rounded news-section">
				<a href="/PatientPages/PatientPortal?section=Profile" class="btn btn-primary bg-black bg-opacity-50">Profile</a> <!-- If navigation successful: section = "Profile" -->
				<a href="/PatientPages/PatientPortal?section=Appointments" class="btn btn-primary bg-black bg-opacity-50">Appointments</a>
				<a href="/PatientPages/PatientPortal?section=Medical Records" class="btn btn-primary bg-black bg-opacity-50">Medical Records</a>
				<a href="/PatientPages/PatientPortal?section=Prescriptions" class="btn btn-primary bg-black bg-opacity-50">Prescriptions</a>
			</div>
		</div>

		<!-- Generated content based on menu-choice -->
		<div class="col ms-2">
			@if (section == "Profile")
			{
				<h2>Profile</h2>
				<table class="table">
					<thead>
						<tr>
							<th>Name</th>
							<th>Date of Birth</th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<td>@Model.CurrentPatient.Name</td>
							<td>@Model.CurrentPatient.DateOfBirth</td>
						</tr>
					</tbody>
				</table>
			}
			else if (section == "Appointments")
			{
				<h2>Appointments</h2>
				<table class="table">
					<thead>
						<tr>
							<th>Date</th>
							<th>Doctor</th>
						</tr>
					</thead>
					<tbody>
						@foreach (var appointment in Model.Appointments)
						{
							<tr>
								<td>@appointment.DateOfAppointment</td>
								<td>@appointment.Staff.Name</td>
							</tr>
						}
					</tbody>
				</table>

				<!-- Schedule Appointment button -->
				<a href="/Appointments/Index" class="btn btn-outline-primary">Schedule appointment</a>
			}
			else if (section == "ScheduleAppointment")
			{
				<form method="post" asp-page-handler="Book">
					<h2>Schedule appointment</h2>
					<p class="mt-2 mb-2"></p>
					<div class="mb-3">
						<label asp-for="Appointment.DateOfAppointment" class="form-label"></label>
						<input asp-for="Appointment.DateOfAppointment" type="datetime-local" class="form-control" />
					</div>

					<div class="mb-3">
						<label asp-for="Appointment.Reason" class="form-label"></label>
						<input asp-for="Appointment.Reason" class="form-control" />
					</div>

					<div class="mb-3">
						<label asp-for="Appointment.StaffId" class="form-label">Select Doctor</label>
						<select asp-for="Appointment.StaffId" class="form-select" asp-items="Model.SelectStaffList" />
					</div>

					<button type="submit" class="btn btn-primary">Book Appointment</button>
				</form>
			}
			else if (section == "Medical Records")
			{
				<h2>Medical Records</h2>
				<table class="table">
					<thead>
						<tr>
							<th>Date of visit</th>
							<th>Reason</th>
							<th>Notes</th>
							<th>Prescriptions</th>
						</tr>
					</thead>
					<tbody>
						@foreach (var history in Model.MedicalHistory)
						{
							<tr>
								<td>@history.DateOfVisit</td>
								<td>@history.Reason</td>
								<td>@history.Notes</td>
								<td>@history.Prescriptions</td>
							</tr>
						}
					</tbody>
				</table>
			}
			else if (section == "Prescriptions")
			{
				<h2>Prescriptions</h2>
				<table class="table">
					<thead>
						<tr>
							<th>Date of visit</th>
							<th>Reason</th>
							<th>Prescriptions</th>
						</tr>
					</thead>
					<tbody>
						@foreach (var history in Model.MedicalHistory)
						{
							<tr>
								<td>@history.DateOfVisit</td>
								<td>@history.Reason</td>
								<td>@history.Prescriptions</td>
							</tr>
						}
					</tbody>
				</table>
			}
		</div>
	</div>
</div>